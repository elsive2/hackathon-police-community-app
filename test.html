<script type="importmap">
    {
      "imports": {
        "@stomp/stompjs": "https://ga.jspm.io/npm:@stomp/stompjs@7.0.0/esm6/index.js",
        "sockjs-client": "https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"
      }
    }
</script>

<script async src="https://ga.jspm.io/npm:es-module-shims@1.7.2/dist/es-module-shims.js"></script>

<script type="module">
    import { Client } from "@stomp/stompjs";
    import * as SockJS from "sockjs-client"; // âœ… Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚

    const socket = new SockJS("http://localhost:6206/ws"); // âœ… Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

    const client = new Client({
        webSocketFactory: () => socket, // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ SockJS
        debug: (str) => console.log("STOMP: " + str),
        reconnectDelay: 5000,
        heartbeatIncoming: 4000,
        heartbeatOutgoing: 4000,
    });

    client.onConnect = (frame) => {
        console.log("âœ… Connected to WebSocket");
        client.subscribe("/topic/messages", (message) =>
            console.log("ğŸ“© Received:", message.body)
        );
        client.publish({
            destination: "/app/chat",
            body: JSON.stringify({ content: "Hello from frontend!" }),
        });
    };

    client.onStompError = (frame) => {
        console.error("âŒ STOMP Error:", frame.headers.message);
        console.error("ğŸ“„ Details:", frame.body);
    };

    client.activate();


</script>